# 对比学习及在召回和排序上的应用

[对比学习及在召回和排序上的应用 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/646779275)

> 打算工业落地

## 对比学习在召回上的应用

### 拟对比学习

由于双塔模型和对比学习的架构完全类似，因而可以将对比学习迁移到双塔中，里面的很多结论在双塔中也同样使用。要注意的有以下几点：

1. 正样本是用户点击的item，负样本是batch内负采样，且batch_size越大效果越好。
2. 在得到user emb和item emb后，进行一次L2 Norm的操作
3. Loss使用对比学习loss替换CE loss，并且增加温度参数

![img](https://pic2.zhimg.com/80/v2-b7be994aab6044059026d896a36f99b5_720w.webp)

> 优点：在原模型上直接改Loss 即可
>
> 问题A ：loss 如何设计



### 更纯正的对比学习

main和对比学习一致，在item侧，将item特征随机dropout掉一部分，或者mask掉一部分，形成两个新的item特征，且这两个特征互相作为正例，学习一个新的对比loss。**其中辅助任务item网络参数和主任务item网络参数是共享的**，负样本同样使用batch内负采样实现，α用来控制辅助loss的权重。同样，在user侧也可以这样做，实验表明都是有效的。

![img](https://pic2.zhimg.com/80/v2-3411f5803183f143a9cf4c62d6d85539_720w.webp)

> 优点：也可以直接在原模型上训练
>
> 难点：item 和user 特征上需要进行DropOut

在文章的最后，再强调一下对比学习的作用：**解决user和item的长尾问题，使得打出的emb更可靠**。因为它会拉进正样本之间的距离，扩大负样本之间的距离。这样长尾的正样本也能学的充分